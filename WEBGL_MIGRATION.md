# WebGL 重写说明

## 改动概述

已将原有的 CPU 光线追踪渲染器重写为 WebGL 版本，在 GPU 上并行执行光线追踪计算，大幅提升渲染性能。

## 新增文件

1. **src/shaders/vertex.glsl** - 顶点着色器
2. **src/shaders/fragment.glsl** - 片段着色器（包含完整的光线追踪逻辑）
3. **src/webgl-renderer.ts** - WebGL 渲染器封装
4. **vite.config.ts** - Vite 配置，支持 GLSL 文件导入
5. **src/vite-env.d.ts** - TypeScript 类型声明

## 修改文件

- **src/main.ts** - 简化为使用 WebGL 渲染器，删除了所有 CPU 光线追踪代码

## 保持不变

- 场景定义（src/scene.ts）
- 相机控制逻辑
- 渲染结果（视觉效果完全一致）
- 用户交互（按钮控制）

## 性能提升

WebGL 版本利用 GPU 并行计算能力，将光线追踪的每个像素的计算并行化：

- **原版本**: 400x400 = 160,000 像素串行计算
- **新版本**: 160,000 像素在 GPU 上并行计算

预计性能提升 10-100 倍（取决于硬件配置）。

## 技术要点

1. **着色器实现**: 将完整的光线追踪算法（光线-球体相交、光照计算、反射）用 GLSL 实现
2. **数据传输**: 通过 uniform 变量将场景数据（球体、光源）传递到 GPU
3. **递归改循环**: 由于 GLSL 不支持递归，将递归的反射计算改为循环实现
4. **全屏渲染**: 使用全屏四边形，在片段着色器中为每个像素执行光线追踪

## 使用方法

运行方式与之前完全相同：

```bash
pnpm dev
```

打开浏览器后，使用控制按钮旋转相机查看场景。
